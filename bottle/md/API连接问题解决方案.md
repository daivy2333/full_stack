# 漂流瓶应用 API 连接问题解决方案

## 问题描述

当您看到以下错误时：
```
GET http://127.0.0.1:5500/api/get_user_saved_bottles 404 (Not Found)
```

这表示前端应用无法连接到后端服务器，因为：
1. 前端尝试连接的端口（5500）与后端服务器运行的端口（3000）不匹配
2. API路径不正确

## 解决方案

### 1. 启动后端服务器

首先，确保您的后端服务器正在运行。您可以使用以下方法之一：

#### 方法A：使用批处理脚本（推荐）
直接双击运行项目根目录下的 `start_backend.bat` 文件

#### 方法B：手动启动
1. 打开命令提示符或PowerShell
2. 导航到后端目录：`cd backend`
3. 安装依赖（如果尚未安装）：`npm install`
4. 启动服务器：`npm start`

### 2. 确认数据库配置

确保MySQL数据库正在运行，并且已创建名为 `drift_bottle` 的数据库。如果需要，您可以运行 `init_db.sql` 脚本来初始化数据库结构。

### 3. 前端API配置

前端API配置已经修复，现在会正确连接到 `http://127.0.0.1:3000/api`，而不是之前的 `http://127.0.0.1:5500/api`。

### 4. 验证修复

1. 确保后端服务器正在运行（应该在控制台看到 "服务器运行在端口 3000" 的消息）
2. 刷新前端页面
3. 检查浏览器控制台，确认没有更多的404错误

## 常见问题

### 问题：数据库连接失败
**解决方案**：
1. 检查MySQL服务是否运行
2. 确认数据库配置文件 `backend/config/db.js` 中的连接信息是否正确
3. 确认已创建数据库并运行初始化脚本

### 问题：端口被占用
**解决方案**：
1. 使用 `netstat -ano | findstr :3000` 查找占用3000端口的进程
2. 结束该进程或修改后端服务器使用的端口

### 问题：依赖安装失败
**解决方案**：
1. 确保Node.js已正确安装
2. 尝试清除npm缓存：`npm cache clean --force`
3. 删除 `node_modules` 文件夹并重新运行 `npm install`

## 技术细节

修复的API端点：
- `get_user_saved_bottles` → `user/saves`
- `save_bottle` → `user/saves` (POST)
- `unsave_bottle` → `user/saves/:id` (DELETE)

这些更改使前端API调用与后端路由保持一致。
